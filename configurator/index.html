<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Porsche Configurator</title>
    <meta name="description" content="Configure your Porsche 911 — choose exterior colors and explore in 3D." />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;900&family=Barlow:wght@300;400;500;600;700&display=swap"
        rel="stylesheet" />

    <link rel="stylesheet" href="style.css" />

    <!-- Three.js -->
    <script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@0.162.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.162.0/examples/jsm/"
    }
  }
  </script>

    <!-- Model Viewer for AR -->
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
</head>

<body>

    <!-- ── Top Nav ────────────────────────────────────── -->
    <nav class="config-nav">
        <a href="../index.html" class="nav-back" title="Back to Models">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6" />
            </svg>
            <span>Back</span>
        </a>
        <div class="nav-logo">PORSCHE<span>.</span></div>
        <div class="nav-title" id="nav-model-name">911 Turbo S</div>
    </nav>

    <!-- ── Main Layout ────────────────────────────────── -->
    <main class="config-layout">

        <!-- Left: 3D Viewer -->
        <section class="viewer-section">
            <div class="viewer-wrap" id="viewer-wrap">
                <canvas id="config-canvas" aria-label="3D Car Configurator"></canvas>
                <div class="viewer-loading" id="viewer-loading">
                    <div class="loading-spinner"></div>
                    <div class="loading-bar">
                        <div class="loading-bar-fill" id="loading-bar-fill"></div>
                    </div>
                    <span class="loading-pct" id="loading-pct">0%</span>
                </div>
            </div>

            <!-- Car title overlay -->
            <div class="viewer-car-title">
                <h1 id="car-name">911 Turbo S</h1>
                <p id="car-tagline">The icon. Reimagined.</p>
            </div>
        </section>

        <!-- Right: Config Panel -->
        <aside class="config-panel">
            <div class="panel-section">
                <h2 class="panel-title">Configurations</h2>
                <div class="panel-divider"></div>
            </div>

            <div class="panel-section">
                <h3 class="section-label">Exterior Color</h3>
                <div class="color-options" id="color-options">
                    <!-- Populated by JS -->
                </div>
            </div>

            <div class="panel-section">
                <h3 class="section-label">Controls</h3>
                <div class="controls-row">
                    <button class="ctrl-btn active" id="btn-rotate" title="Auto Rotate">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M21 12a9 9 0 11-6.219-8.56" />
                            <polyline points="21 3 21 9 15 9" />
                        </svg>
                        <span>Rotate</span>
                    </button>
                    <button class="ctrl-btn" id="btn-reset" title="Reset View">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="3" />
                            <path d="M12 2v4m0 12v4M2 12h4m12 0h4" />
                        </svg>
                        <span>Reset</span>
                    </button>
                    <button class="ctrl-btn" id="btn-ar" title="View in AR">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M12 3L2 8l10 5 10-5-10-5z" />
                            <path d="M2 8v8l10 5 10-5V8" />
                            <path d="M12 13v8" />
                        </svg>
                        <span>AR View</span>
                    </button>
                </div>
            </div>
        </aside>

    </main>

    <!-- ── Bottom Stats Bar ───────────────────────────── -->
    <footer class="stats-bar">
        <div class="stat-card" id="stat-performance">
            <div class="stat-card-header">
                <span class="stat-title">Performance</span>
            </div>
            <div class="stat-big-value">
                <span id="stat-speed" class="stat-number">330</span>
                <span class="stat-unit">km/h</span>
            </div>
            <div class="stat-detail">
                <span class="stat-dot"></span>
                <span>0–100 km/h</span>
                <strong id="stat-accel">2.7 sec</strong>
            </div>
            <div class="stat-detail">
                <span class="stat-dot"></span>
                <span>Engine</span>
                <strong id="stat-engine">Twin-Turbo Flat-6</strong>
            </div>
        </div>

        <div class="stat-card" id="stat-power">
            <div class="stat-card-header">
                <span class="stat-title">Power</span>
            </div>
            <div class="stat-big-value">
                <span id="stat-hp" class="stat-number">650</span>
                <span class="stat-unit">HP</span>
            </div>
            <div class="stat-bar-wrap">
                <div class="stat-bar-track">
                    <div class="stat-bar-fill" id="power-bar" style="width: 87%;"></div>
                </div>
            </div>
        </div>

        <div class="stat-card stat-card-accent" id="stat-config">
            <div class="stat-card-header">
                <span class="stat-title">Your Configuration</span>
            </div>
            <div class="stat-config-color">
                <span class="config-color-dot" id="config-color-dot" style="background: #c0392b;"></span>
                <span id="config-color-name">Carmine Red</span>
            </div>
            <div class="stat-detail">
                <span class="stat-dot"></span>
                <span>Model</span>
                <strong id="config-model">911 Turbo S</strong>
            </div>
        </div>
    </footer>

    <!-- Hidden model-viewer for AR activation -->
    <model-viewer
        id="ar-model"
        src="../models/porsche_911_interior.glb"
        ar
        ar-modes="webxr scene-viewer quick-look"
        ar-scale="auto"
        camera-controls
        shadow-intensity="1"
        style="position:fixed; width:1px; height:1px; opacity:0; pointer-events:none; top:-9999px;"
    ></model-viewer>

    <!-- AR Unsupported Modal -->
    <div id="ar-modal" style="display:none; position:fixed; inset:0; z-index:9999; background:rgba(0,0,0,0.7); backdrop-filter:blur(8px); align-items:center; justify-content:center;">
        <div style="background:rgba(18,19,22,0.95); border:1px solid rgba(255,255,255,0.1); border-radius:16px; padding:2.5rem; max-width:380px; text-align:center; font-family:'Barlow',sans-serif;">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#c0392b" stroke-width="1.5" style="margin-bottom:1rem;">
                <path d="M12 3L2 8l10 5 10-5-10-5z"/>
                <path d="M2 8v8l10 5 10-5V8"/>
                <path d="M12 13v8"/>
            </svg>
            <h3 style="font-family:'Orbitron',sans-serif; font-size:1.1rem; color:#fff; margin-bottom:0.8rem;">AR Not Available</h3>
            <p style="font-size:0.85rem; color:rgba(255,255,255,0.6); line-height:1.6; margin-bottom:1.5rem;">
                Augmented Reality requires a supported mobile device.<br>
                Open this page on your <strong style="color:#c0392b;">phone or tablet</strong> to place the Porsche in your space.
            </p>
            <button onclick="document.getElementById('ar-modal').style.display='none'" style="padding:0.6em 1.8em; font-family:'Barlow',sans-serif; font-size:0.75rem; font-weight:600; letter-spacing:0.15em; text-transform:uppercase; color:#fff; background:rgba(192,57,43,0.85); border:1px solid rgba(192,57,43,0.5); border-radius:24px; cursor:pointer;">Got it</button>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>

</html>